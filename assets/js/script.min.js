'use strict';

var accordeonList = convertToArray(document.querySelectorAll('.accordeon'));

if (accordeonList) {
  accordeonList.forEach(function (block) {
    var accordeonTabLinks = convertToArray(block.querySelectorAll('.accordeon__item-nav-link'));
    var accordeonItemsContentList = convertToArray(block.querySelectorAll('.accordeon__item-content'));
    if (accordeonTabLinks && accordeonItemsContentList) {
      accordeonTabLinks.forEach(function (link) {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          accordeonTabLinks.forEach(function (navLink) {
            navLink.classList.remove('accordeon__item-nav-link--active');
          });
          accordeonItemsContentList.forEach(function (accordeonItemsContent) {
            accordeonItemsContent.classList.remove('accordeon__item-content--active');
          });
          var activeAccordeonItemID = e.target.getAttribute('data-tab-id');
          e.target.classList.add('accordeon__item-nav-link--active');
          console.log(document.getElementById(activeAccordeonItemID));
          document.getElementById(activeAccordeonItemID).classList.add('accordeon__item-content--active');
        });
      });
    }
  });
}
//валидация формы запроса обратного звонка
// let consultForm = document.querySelector('.order-form__content--call-form');
// let consultFormSubmitBtn = consultForm.querySelector('.action--submit-form');
// if(consultForm){
//   let personNameValidity = false;
//   let personPhoneValidity = false;
//   let personNameField = consultForm.querySelector('input[name=answers-name]');
//   personNameField.addEventListener("blur", function(){
//     console.log('blur');
//     if ((personNameField.value.includes('Например:'))||(personNameField.value=="")) { 
//       //console.log('personNameField не валидно');
//       $('.order-form__content--call-form input[name=answers-name]').notify("Поле нужно заполнить111", "error"); 
//       $('.order-form__content--call-form input[name=answers-name]').addClass("errtextbox");
//       personNameValidity=false;
//     }
//     else{
//       personNameValidity=true;
//       $('.order-form__content--call-form input[name=answers-name]').removeClass("errtextbox");
//     }
//   })
//   let personPhoneField = consultForm.querySelector('input[name=answers-phone]');
//   personPhoneField.addEventListener("blur", function(){
//     //console.log('blur2');
//     if (personPhoneField.value=="") { 
//       //console.log('personPhoneField не валидно');
//       $('.order-form__content--call-form input[name=answers-phone]').notify("Поле нужно заполнить222", "error"); 
//       $('.order-form__content--call-form input[name=answers-phone]').addClass("errtextbox");
//       personPhoneValidity=false;
//       //console.log((personPhoneValidity&&personNameValidity));
//     }
//     else{
//       personPhoneValidity=true;
//       $('.order-form__content--call-form input[name=answers-phone]').removeClass("errtextbox");
//       //console.log(!(personPhoneValidity&&personNameValidity));
//     }
//   })

//   consultFormSubmitBtn.addEventListener('click', function(e){
//     e.preventDefault();
//     if((personPhoneValidity&&personNameValidity)){
//       $('.order-form__content--call-form').submit();
//       console.log('Форма успешно отправлена');
//       document.body.removeAttribute("class");
//     }
//     else{
//       e.preventDefault();
//       console.log('personPhoneValidity is '+personPhoneValidity);
//       console.log('personNameValidity is '+personNameValidity);
//       $('.order-form__content--call-form').notify("Не все поля корректно заполнены", "error");
//       $('.order-form__content--call-form').addClass("errtextbox");
//     }
//   })
// }
"use strict";
"use strict";

document.addEventListener("DOMContentLoaded", function () {
  var lazyloadImages;

  if ("IntersectionObserver" in window) {
    lazyloadImages = document.querySelectorAll(".lazy");
    var imageObserver = new IntersectionObserver(function (entries, observer) {
      entries.forEach(function (entry) {
        if (entry.isIntersecting) {
          var image = entry.target;
          image.classList.remove("lazy");
          imageObserver.unobserve(image);
        }
      });
    });

    lazyloadImages.forEach(function (image) {
      imageObserver.observe(image);
    });
  } else {
    var lazyload = function lazyload() {
      if (lazyloadThrottleTimeout) {
        clearTimeout(lazyloadThrottleTimeout);
      }

      lazyloadThrottleTimeout = setTimeout(function () {
        var scrollTop = window.pageYOffset;
        lazyloadImages.forEach(function (img) {
          if (img.offsetTop < window.innerHeight + scrollTop) {
            img.src = img.dataset.src;
            img.classList.remove('lazy');
          }
        });
        if (lazyloadImages.length == 0) {
          document.removeEventListener("scroll", lazyload);
          window.removeEventListener("resize", lazyload);
          window.removeEventListener("orientationChange", lazyload);
        }
      }, 20);
    };

    var lazyloadThrottleTimeout;
    lazyloadImages = document.querySelectorAll(".lazy");

    document.addEventListener("scroll", lazyload);
    window.addEventListener("resize", lazyload);
    window.addEventListener("orientationChange", lazyload);
  }
});
"use strict";

var screenWidth = document.documentElement.clientWidth;
var body = document.querySelector('body');
var isMobile = {
	Android: function Android() {
		return navigator.userAgent.match(/Android/i);
	},
	BlackBerry: function BlackBerry() {
		return navigator.userAgent.match(/BlackBerry/i);
	},
	iOS: function iOS() {
		return navigator.userAgent.match(/iPhone|iPad|iPod/i);
	},
	Opera: function Opera() {
		return navigator.userAgent.match(/Opera Mini/i);
	},
	Windows: function Windows() {
		return navigator.userAgent.match(/IEMobile/i);
	},
	any: function any() {
		return isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows();
	}
};

if (isMobile.any()) {
	document.body.classList.add('_touch');

	var menuArrows = document.querySelectorAll('.menu__arrow');
	if (menuArrows.length > 0) {
		var _loop = function _loop(index) {
			var menuArrow = menuArrows[index];
			menuArrow.addEventListener("click", function (e) {
				menuArrow.parentElement.classList.toggle('_active');
			});
		};

		for (var index = 0; index < menuArrows.length; index++) {
			_loop(index);
		}
	}
} else {
	document.body.classList.add('_pc');
}

//еслм Safari, то навесим класс
// function determineBrowser() { 
// 	if(navigator.userAgent.indexOf("Safari") != -1) 
//  {
// 		 document.body.classList.add('safari');
//  }
//  }

determineSafari();

function determineSafari() {
	if ((navigator.userAgent.indexOf("Opera") || navigator.userAgent.indexOf('OPR')) != -1) {} else if (navigator.userAgent.indexOf("Chrome") != -1) {} else if (navigator.userAgent.indexOf("Safari") != -1) {
		document.body.classList.add('safari');
	} else if (navigator.userAgent.indexOf("Firefox") != -1) {} else if (navigator.userAgent.indexOf("MSIE") != -1 || !!document.documentMode == true) //IF IE > 10
		{} else {}
}

/* липкий header*/
// let header = document.querySelector(".header");
// if(header){
// 	(function(){
// 		window.onscroll = function() {stickyHeader()};
// 		let sticky = 0;
// 		function stickyHeader() {
// 			if (window.pageYOffset > sticky) {
// 				header.classList.add("sticky-header");
// 			} else {
// 				header.classList.remove("sticky-header");
// 			}
// 		}
// 	})();
// }


// Меню бургер
var tooggleMenu = document.querySelector('.header__tooggle-menu');
var headerContent = document.querySelector('.header__content');
var menuHamburger = document.querySelector('.header__hamburger-img');
var menuCross = document.querySelector('.header__cross-img');
if (tooggleMenu) {
	tooggleMenu.addEventListener('click', function () {
		tooggleMenu.classList.toggle('header__tooggle-menu--cross');
		headerContent.classList.toggle('header__content--visible');
	});
}

//показываем и скрываем списки и подменю
var hiddenItemsControls = document.querySelectorAll('.hidden-items-control');
if (hiddenItemsControls) {
	hiddenItemsControls.forEach(function (element) {
		element.addEventListener('click', function (e) {
			e.preventDefault();
			e.target.classList.toggle('open-state');
			var parentElement = e.target.closest('.parent-item');
			parentElement.classList.toggle('open-state');
			var sublist = e.target.closest('.parent-item').nextSibling.nextElementSibling;
			sublist.classList.toggle('show');
		});
	});
}

//меню футер
var footerMenu = document.querySelector('.footer__mobile-nav-wrap');
if (footerMenu && screenWidth < 769) {
	var scrollPos = 0;
	$(window).scroll(function () {
		var st = $(this).scrollTop();
		if (st > scrollPos) {
			//$('#result').html('Вниз');
			document.querySelector('footer').classList.add('show-footer-menu');
		} else {
			//$('#result').html('Вверх');
			document.querySelector('footer').classList.remove('show-footer-menu');
		}
		scrollPos = st;
	});
}

//появление корзины


var iconCart = document.querySelector('.mini-cart__header');
var closeCartBtn = document.querySelector('.mini-cart__icon-close');
var navCartOverlay = document.querySelector('.mobile-nav-under-cart');
if (iconCart) {
	iconCart.addEventListener("click", function (e) {
		document.body.classList.add('_lock-cart');
	});
}
if (closeCartBtn) {
	closeCartBtn.addEventListener("click", function (e) {
		document.body.classList.remove('_lock-cart');
	});
}
if (navCartOverlay) {
	navCartOverlay.addEventListener("click", function (e) {
		document.body.classList.remove('_lock-cart');
	});
}

//кастомизируем select
// $('.custom-select').each(function() {
//   $(this).niceSelect();
// });
"use strict";
'use strict';

//конвертируем коллекцию в массив
function convertToArray(collection) {
  var newArray = Array.prototype.slice.call(collection);
  return newArray;
}

//маска номера телефона
$(document).ready(function () {
  $('.input-field--phone').mask("+375 (99) 999-99-99");
});

//кастомизируем select


var closeFormBtns = convertToArray(document.querySelectorAll('.closeFormBtn'));
var forms = document.querySelectorAll('form');
if (closeFormBtns) {
  closeFormBtns.forEach(function (btn) {
    btn.addEventListener('click', function (e) {
      e.preventDefault();
      document.body.removeAttribute("class");
      forms.forEach(function (form) {
        return form.reset();
      });
    });
  });
}

//клик по месту вне формы
var orderFormOverlay = document.querySelector('.modal__overlay');

if (orderFormOverlay) {
  orderFormOverlay.addEventListener('click', function () {
    document.body.removeAttribute("class");
    forms.forEach(function (form) {
      return form.reset();
    });
  });
}

//вызов форм для калькуляторов заборов и ворот, квиза
function openCalcForm(btnClass) {
  var btnsCalc = convertToArray(document.querySelectorAll('.' + btnClass));
  if (btnsCalc) {
    btnsCalc.forEach(function (btn) {
      btn.addEventListener('click', function (e) {
        e.preventDefault();
        document.body.classList.add('modal-view');
        document.body.classList.add(btnClass);
      });
    });
  }
}
openCalcForm('call-form');
openCalcForm('order-online');

function openOrderForm(btnClass) {
  var btnsCalc = convertToArray(document.querySelectorAll('.' + btnClass));
  if (btnsCalc) {
    btnsCalc.forEach(function (btn) {
      btn.addEventListener('click', function (e) {
        e.preventDefault();
        var transportName = btn.closest('.car').querySelector('.car__title').innerHTML;
        document.querySelector('.transport-name').value = transportName;
        document.body.classList.add('modal-view');
        document.body.classList.add(btnClass);
      });
    });
  }
}
openOrderForm('order-transport');

var TOKEN = '5477703463:AAGlt6r7osdT9QmZpG2ksKcpBkbAWrKGyT0';
var CHAT_ID = '-792442518';

var orderCallForm = document.querySelector('.modal__content--call-form form');
orderCallForm.addEventListener("submit", function (e) {
  e.preventDefault();
  var data = new FormData(this);

  var messageText = 'Клиент просит перезвонить\n\n' + 'Имя клиента ' + data.get("person-name") + '\nТелефон: ' + data.get("person-phone");
  sendMsg(messageText);
});

var orderTransportForm = document.querySelector('.modal__content--order-transport form');
orderTransportForm.addEventListener("submit", function (e) {
  e.preventDefault();
  var data = new FormData(this);
  var messageText = 'Клиент заказывает авто\n\n' + 'Авто\n' + data.get("transport-name") + '\nИмя клиента ' + data.get("transport-person") + '\nТелефон: ' + data.get("person-phone") + '\nДата поездки: ' + data.get("transport-date");
  console.log(messageText);
  sendMsg(messageText);
});

var orderBottomForm = document.querySelector('.answers__form--bottom');
orderBottomForm.addEventListener("submit", function (e) {
  e.preventDefault();
  var data = new FormData(this);
  var messageText = 'Клиент интересуется стоимостью сделки\n\n' + 'Имя клиента ' + data.get("person-name") + '\nТелефон: ' + data.get("person-phone") + '\nСообщение клиента: ' + data.get("person-message");
  sendMsg(messageText);
});

function sendMsg(data) {
  var url = 'https://api.telegram.org/bot' + TOKEN + '/sendMessage'; // токен бота
  var body = JSON.stringify({
    chat_id: CHAT_ID,
    parse_mode: 'Markdown',
    text: data
  });
  var xhr = new XMLHttpRequest();
  xhr.open('POST', url, true);

  // уведомление-модалка
  xhr.onload = function (oEvent) {
    if (xhr.status === 200) {
      document.body.classList.add('modal-view');
      document.body.classList.add('success-send');
    }
    if (xhr.status !== 200) {
      document.body.classList.add('modal-view');
      document.body.classList.add('error-send');
    }
  };
  xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
  xhr.send(body);

  document.body.removeAttribute("class");
  document.body.classList.remove('call-form');
  document.body.classList.remove('order-online');
}
// $(function() {
//     // Owl Carousel
//     var owl = $(".team__list");
//     owl.owlCarousel({
//         loop:true,
//         center: true,
//         margin:10,
//         responsiveClass:true,
//         navContainerClass: 'custom-slider__nav',
//         navClass: ["custom-slider__slider-prev-btn","custom-slider__slider-next-btn"],
//         responsive:{
//             0:{
//                 items:1,
//                 nav:true
//             },
//             767:{
//                 items:3,
//                 autoWidth:true,
//                 nav:false
//             }
//         }
//     });
//   });
"use strict";
'use strict';

var portfolioToggle = document.querySelector('.portfolio__toggle');
var portfolioToggleDesctop = document.querySelector('.portfolio__toggle-control--desctop');
var portfolioToggleMobile = document.querySelector('.portfolio__toggle-control--mobile');

if (portfolioToggleDesctop) {
    portfolioToggleDesctop.addEventListener('click', function () {
        document.querySelector('.portfolio__list').classList.add('portfolio__list--changed');
        portfolioToggleDesctop.style.opacity = '1';
        portfolioToggleMobile.style.opacity = '0.6';
    });
}

if (portfolioToggleMobile) {
    portfolioToggleMobile.addEventListener('click', function () {
        document.querySelector('.portfolio__list').classList.remove('portfolio__list--changed');
        portfolioToggleDesctop.style.opacity = '0.6';
        portfolioToggleMobile.style.opacity = '1';
    });
}
// document.getElementById('bgpreload').addEventListener('load', () =>
//   document.querySelector('.head').classList.add('bgLoaded')
// );
"use strict";
"use strict";
'use strict';

[].forEach.call(document.querySelectorAll('img[data-src]'), function (img) {
  img.setAttribute('src', img.getAttribute('data-src'));
  img.onload = function () {
    img.removeAttribute('data-src');
  };
});

"use strict";
var bg__elements = document.querySelectorAll('.bg-src');
if (bg__elements) {
  bg__elements.forEach(function (element) {
    var bg_img_src = element.getAttribute('data-bg-src');
    element.style.backgroundImage = 'url(' + bg_img_src + ')';
  });
}
"use strict";

var bg__elements = document.querySelectorAll('.bg-src');
if (bg__elements) {
  bg__elements.forEach(function (element) {
    var bg_img_src = element.getAttribute('data-bg-src');
    element.style.backgroundImage = 'url(' + bg_img_src + ')';
  });
}
'use strict';

//слайдер Наша команда


var gallerySlider = new Swiper(".car__photo-wrap", {
  loop: true,
  lazy: true,
  slidesPerView: 1,
  initialSlide: 1,
  spaceBetween: 0,
  autoplay: {
    delay: 4000
  },
  navigation: {
    nextEl: '.swiper-button-next',
    prevEl: '.swiper-button-prev'
  },
  pagination: {
    el: ".swiper-pagination",
    clickable: true
  }
});
"use strict";